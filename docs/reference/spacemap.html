<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit spacemap model — spacemap â€¢ spacemap</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">spacemap</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/tune_sim1.html">Model Tuning</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topherconley/spacemap">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit spacemap model</h1>
    </div>

    
    <p>Estimate partial correlations between response variables (Y)
and perform model selection of predictors (X) based on the spacemap model 
fitted to multivariate data (Y,X).</p>
    

    <pre><span class='fu'>spacemap</span>(<span class='no'>Y.m</span>, <span class='no'>X.m</span>, <span class='no'>slasso</span>, <span class='kw'>sridge</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>rlasso</span>, <span class='no'>rgroup</span>, <span class='kw'>sig</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weight</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>remWeight</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>,
  <span class='kw'>cd_iter</span> <span class='kw'>=</span> <span class='fl'>10000000L</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>Y.m</dt>
      <dd>A numeric matrix (N x Q) representing the response of Q variables on 
N independent observations.</dd>
      <dt>X.m</dt>
      <dd>A numeric matrix (N X P) representing P predictor variables on N 
independent observations.</dd>
      <dt>slasso</dt>
      <dd>A numeric value, the Space-lasso penalty parameter (l_1 norm).</dd>
      <dt>sridge</dt>
      <dd>A numeric value (optional). If not specified, lasso regression 
is used in the Joint Sparse Regression Model (JSRM). Otherwise, elastic net 
regression is used in JSRM and sridge serves as the squared l_2 norm penalty parameter.</dd>
      <dt>rlasso</dt>
      <dd>The MAP-lasso penalty.</dd>
      <dt>rgroup</dt>
      <dd>The MAP-group penalty.</dd>
      <dt>sig</dt>
      <dd>A numeric vector with length being the same as the number of 
columns of Y.m. It is the vector of \(\sigma^{ii}\) (the diagonal of 
the inverse covariance matrix). If not specified, s^ii will be 
estimated during the model fitting with initial values <code>rep(1,p)</code> and  
the iterations of the model fitting (<code>iter</code>) \(\ge 2\). 
Note, the scale of <code>sig</code> does not matter.</dd>
      <dt>weight</dt>
      <dd>A numeric value or vector (Q x 1) specifying the weights or the type of
weights used for each regression in JSRM. The default value is NULL, 
which means all regressions will be weighted equally in the joint model. 
If <code>weight=1</code>, residue variances will be used for weights. 
If <code>weight=2</code>, the estimated degree of each variable will be used for weights. 
Otherwise, it should be a positive numeric vector, whose length is equal to 
the number of columns of Y.m.</dd>
      <dt>remWeight</dt>
      <dd>optional weighting scheme on [fill in details].</dd>
      <dt>iter</dt>
      <dd>An integer specifying the iterations in JSRM for estimating 
\(\sigma^{ii}\) and partial correlations. When <code>sig=NULL</code> and/or 
(<code>weight=NULL</code> or <code>weight=2</code>), then <code>iter</code> \(\ge 2\).</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing 
<ol>
<li> <code>ParCor</code> The estimated partial correlation matrix. 
  </li>
<li> <code>sig.fit</code> The estimated diagonal \(\sigma^{ii}\).
  </li>
<li> <code>Gamma</code> The estimated coefficients of Y on X.
  </li>
<li> <code>rss</code> The residual sums of squares from the model fit. 
  </li>
<li> <code>deltaMax</code> The maximum change in parameter values between the penultimate and ultimate iteration  
</li>
</ol></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>sim1</span>)
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'>spacemap</span>(<span class='kw'>Y.m</span> <span class='kw'>=</span> <span class='no'>sim1</span>$<span class='no'>Y</span>, <span class='kw'>X.m</span> <span class='kw'>=</span> <span class='no'>sim1</span>$<span class='no'>X</span>, <span class='kw'>slasso</span> <span class='kw'>=</span> <span class='fl'>70</span>, <span class='kw'>rlasso</span> <span class='kw'>=</span> <span class='fl'>28.8</span>, <span class='kw'>rgroup</span> <span class='kw'>=</span> <span class='fl'>12.38</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christopher Conley, Jie Peng, Pei Wang, UC Davis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
